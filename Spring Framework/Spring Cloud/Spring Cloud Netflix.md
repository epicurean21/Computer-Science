# Spring Cloud Netflix

Micro Service Architecture (MSA)가 매우 핫하게 발전된 아키텍쳐로서, 현재 실무에서 적용시키기 위해서는 이를 서포트하기위한 여러 기술들이 필요하다. **Netflix** 에서는 MSA를 구현하기 위한 여러 OSS (Open Source Software)를 발표하는데, 이 Spring-cloud-netflix 기술들에 대해 알아보자.



##### "Netflixed" 라는 용어가 존재한다.

이는 기존의 legacy architecture 혹은 code, 비즈니스 모델이 붕괴되었을 때 사용되는 표현이다. Netflix는 기존의 Legacy 시스템을 MSA로 전환하여 운영/개발 상의 효율성을 극대화 하였다.

> *2007년 심각한 데이터베이스 손상으로 3일간 서비스 장애를 겪은 넷플릭스는 신뢰성 높고 수평 확장이 가능한*
> *클라우드 시스템으로 이전할 필요성을 느꼈는데, 단순히 플랫폼 이전만으로는 기존의 문제점과 한계를 탈피할*
> *수 없다고 판단한 넷플릭스는 고가용성, 유연한 스케일링, 빠르고 쉬운 배포를 위해 MSA를 선택하였다고 한다.*
> *그리고 MSA 전환을 위한 기술들을 도입하여 무려 7년에 걸쳐 클라우드 환경으로 이전하였으며, 이 과정에서*
> *넷플릭스가 경험한 노하우와 문제해결 방법을 공유하기 위해 MSA 전환 기술을 오픈소스로 공개 하였다!!!*
> *이렇게 탄생한 넷플릭스 OSS는 MSA를 도입하려는 많은 사람에게 좋은 선택지가 되고 있다.*
>
> 출처: [MSA and Netflix OSS](https://bravenamme.github.io/2020/07/21/msa-netflix/)



![SpringCloudNetflix](./img/SpringCloudNetflix/SpringCloudNetflix.png)



### Eureka

*Service Discovery Server (서비스 디스커버리지 서버)*

MSA 구조에서 서비스를 **동적**으로 확장하고 축소되기도 한다. 이때마다 운영자가 일일이 인스턴스 정보를 수정하거나, 관리하는건 매우 귀찮고 쉽지 않은 일이다. 그렇기에 인스턴스 상태를 동적으로 관리하는 서버가 필요한데, 이를 *서비스 디스크버리 서버*로 칭하며 Netflix에서 Eureka라는 이름으로 공개하였다.

<img src="./img/SpringCloudNetflix/eureka.png" alt="eureka" style="zoom:67%;" />

간단하게, **쪼개진 서비스들의 주소들의 집합체 또는 서비스 registry** 라고 이해하자.

예를 들어보자, 

100개의 서비스가 있다고 하자. 100개의 서비스는 서로간 통신을 하고 있다. 이럴 때 100개의 서비스를 관리하기 위해, 100개에 대한 고메인 또는 IP 정보와 포트 정보를 일일이 다 알고 관리해야 할까?

만약 신규 서비스가 추가되거나, 줄여야 하는 상황이면 다시 수동으로 작성과 관리를 해주어야 하며, 특정 서비스에 장애가 발생하면 그 서비스를 수동으로 제외시켜야 한다. 즉 엄청난 운영 리소스가 들어갈 것이다.



*Eureka*는 이러한 서비스들의 목록들을 자동으로 관리해 준다 !

서비스가 기동될 때 **Eureka 서버**에 자신의 정보 (IP 정보 등)을 Noti 하게되며, Eureka는 등록된 서버들에게 일정 시간동안 heartbeat를 보내며 서비스가 죽었는지 살아있는지를 확인하다. 

각 서비스들은 Eureka 서버에서 정상 작동 목록을 가져와서 사용하게 된다 !







